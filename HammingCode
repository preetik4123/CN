#include <iostream>
using namespace std;
int main() {
    int n;
    cout << "Enter the number of data bits you want to enter: \t";
    cin >> n;
    
    int data[10];
    cout << "Enter the data (0 or 1) ";
    for(int i = 0 ;i<n;i++){
        cin >> data[i];
    }
    
    int r = 0;
    while((1 << r)<n+r+1){
        r++;
    }
    int m = n+r;
    // Calculate parity bit

    int code[20];
    int j = 0;
    
    for(int i = 0 ; i<m ;i++){
        if((i & (i+1)) == 0) code[i] = 0; 
        else code[i] = data[j++];
    }
    
    for(int i = 0 ; i<r;i++){
        int p = 1 << i;
        int parity = 0;
        for(int k = p-1; k<m; k += 2*p){
            for(int l = k ; l < k+p && l < m ; l++){
                parity ^= code[l];
                
            }
            code[p-1] = parity;
        }
    }
    cout <<"Encoded data is as :";
    for(int i = 0; i<m ;i++){
        cout<<code[i];
        
    }
    
    int received[20];
    cout << "\nEnter the received data :";
    for(int i = 0; i<m ;i++){
        cin >> received[i];
        }
        
        int error = 0;
        for(int i = 0 ; i<r ;i++){
            int p =  1 << i;
            int parity = 0;
            for (int k = p-1 ; k < m; k += 2*p){
                for(int l = k ; l < k+p && l < m ; l++){
                    parity ^= received[l];
                }
                if (parity != 0) error += p;
            }
        }
        
        if (error) {
            cout << "Error is detected  at position "<<error<<endl;
            received[error-1] ^= 1;
        }
        else{
            cout <<"No error is detected"<<endl;
        }
        cout << "Decoded data: ";
    for (int i = 0; i < m; i++) {
        if ((i & (i + 1)) != 0) cout << received[i];
    }
    cout << endl;

    return 0;
        
        
    
    
}
